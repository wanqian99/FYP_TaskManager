{"version":3,"file":"errors.js","names":["ErrorWithStack","Error","constructor","message","callsite","captureStackTrace","createLibraryNotSupportedError","error","prepareErrorMessage","name","value","errorMessage","replace","toString","prettyFormat","min","createQueryByError","includes","copyStackTrace","target","stackTraceSource","stack","warned","printDeprecationWarning","functionName","console","warn","throwRemovedFunctionError","docsRef","throwRenamedFunctionError","newFunctionName"],"sources":["../../src/helpers/errors.ts"],"sourcesContent":["import prettyFormat from 'pretty-format';\n\nexport class ErrorWithStack extends Error {\n  constructor(message: string | undefined, callsite: Function) {\n    super(message);\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, callsite);\n    }\n  }\n}\n\nexport const createLibraryNotSupportedError = (error: unknown): Error =>\n  new Error(\n    `Currently the only supported library to search by text is \"react-native\".\\n\\n${\n      error instanceof Error ? error.message : ''\n    }`\n  );\n\nexport const prepareErrorMessage = (\n  // TS states that error caught in a catch close are of type `unknown`\n  // most real cases will be `Error`, but better safe than sorry\n  error: unknown,\n  name?: string,\n  value?: unknown\n): string => {\n  let errorMessage: string;\n  if (error instanceof Error) {\n    // Strip info about custom predicate\n    errorMessage = error.message.replace(\n      / matching custom predicate[^]*/gm,\n      ''\n    );\n  } else if (error && typeof error === 'object') {\n    errorMessage = error.toString();\n  } else {\n    errorMessage = 'Caught unknown error';\n  }\n\n  if (name && value) {\n    errorMessage += ` with ${name} ${prettyFormat(value, { min: true })}`;\n  }\n  return errorMessage;\n};\n\nexport const createQueryByError = (\n  error: unknown,\n  callsite: Function\n): null => {\n  if (error instanceof Error) {\n    if (error.message.includes('No instances found')) {\n      return null;\n    }\n    throw new ErrorWithStack(error.message, callsite);\n  }\n\n  throw new ErrorWithStack(\n    // generic refining of `unknown` is very hard, you cannot do `'toString' in error` or anything like that\n    // Converting as any with extra safe optional chaining will do the job just as well\n    `Query: caught unknown error type: ${typeof error}, value: ${(\n      error as any\n    )?.toString?.()}`,\n    callsite\n  );\n};\n\nexport function copyStackTrace(target: unknown, stackTraceSource: Error) {\n  if (target instanceof Error && stackTraceSource.stack) {\n    target.stack = stackTraceSource.stack.replace(\n      stackTraceSource.message,\n      target.message\n    );\n  }\n}\n\nconst warned: { [functionName: string]: boolean } = {};\n\nexport function printDeprecationWarning(functionName: string) {\n  if (warned[functionName]) {\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.warn(`\n  Deprecation Warning:\n  Use of ${functionName} is not recommended and will be deleted in future versions of @testing-library/react-native.\n  `);\n\n  warned[functionName] = true;\n}\n\nexport function throwRemovedFunctionError(\n  functionName: string,\n  docsRef: string\n) {\n  throw new Error(\n    `\"${functionName}\" has been removed.\\n\\nPlease consult: https://callstack.github.io/react-native-testing-library/docs/${docsRef}`\n  );\n}\n\nexport function throwRenamedFunctionError(\n  functionName: string,\n  newFunctionName: string\n) {\n  throw new ErrorWithStack(\n    `The \"${functionName}\" function has been renamed to \"${newFunctionName}\". Please replace all occurrences.`,\n    throwRenamedFunctionError\n  );\n}\n"],"mappings":";;;;;;;;;;;AAAA;AAAyC;AAElC,MAAMA,cAAc,SAASC,KAAK,CAAC;EACxCC,WAAW,CAACC,OAA2B,EAAEC,QAAkB,EAAE;IAC3D,KAAK,CAACD,OAAO,CAAC;IACd,IAAIF,KAAK,CAACI,iBAAiB,EAAE;MAC3BJ,KAAK,CAACI,iBAAiB,CAAC,IAAI,EAAED,QAAQ,CAAC;IACzC;EACF;AACF;AAAC;AAEM,MAAME,8BAA8B,GAAIC,KAAc,IAC3D,IAAIN,KAAK,CACN,gFACCM,KAAK,YAAYN,KAAK,GAAGM,KAAK,CAACJ,OAAO,GAAG,EAC1C,EAAC,CACH;AAAC;AAEG,MAAMK,mBAAmB,GAAG,CAGjCD,KAAc,EACdE,IAAa,EACbC,KAAe,KACJ;EACX,IAAIC,YAAoB;EACxB,IAAIJ,KAAK,YAAYN,KAAK,EAAE;IAC1B;IACAU,YAAY,GAAGJ,KAAK,CAACJ,OAAO,CAACS,OAAO,CAClC,kCAAkC,EAClC,EAAE,CACH;EACH,CAAC,MAAM,IAAIL,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7CI,YAAY,GAAGJ,KAAK,CAACM,QAAQ,EAAE;EACjC,CAAC,MAAM;IACLF,YAAY,GAAG,sBAAsB;EACvC;EAEA,IAAIF,IAAI,IAAIC,KAAK,EAAE;IACjBC,YAAY,IAAK,SAAQF,IAAK,IAAG,IAAAK,qBAAY,EAACJ,KAAK,EAAE;MAAEK,GAAG,EAAE;IAAK,CAAC,CAAE,EAAC;EACvE;EACA,OAAOJ,YAAY;AACrB,CAAC;AAAC;AAEK,MAAMK,kBAAkB,GAAG,CAChCT,KAAc,EACdH,QAAkB,KACT;EACT,IAAIG,KAAK,YAAYN,KAAK,EAAE;IAC1B,IAAIM,KAAK,CAACJ,OAAO,CAACc,QAAQ,CAAC,oBAAoB,CAAC,EAAE;MAChD,OAAO,IAAI;IACb;IACA,MAAM,IAAIjB,cAAc,CAACO,KAAK,CAACJ,OAAO,EAAEC,QAAQ,CAAC;EACnD;EAEA,MAAM,IAAIJ,cAAc;EACtB;EACA;EACC,qCAAoC,OAAOO,KAAM,YAChDA,KAAK,EACJM,QAAQ,IAAK,EAAC,EACjBT,QAAQ,CACT;AACH,CAAC;AAAC;AAEK,SAASc,cAAc,CAACC,MAAe,EAAEC,gBAAuB,EAAE;EACvE,IAAID,MAAM,YAAYlB,KAAK,IAAImB,gBAAgB,CAACC,KAAK,EAAE;IACrDF,MAAM,CAACE,KAAK,GAAGD,gBAAgB,CAACC,KAAK,CAACT,OAAO,CAC3CQ,gBAAgB,CAACjB,OAAO,EACxBgB,MAAM,CAAChB,OAAO,CACf;EACH;AACF;AAEA,MAAMmB,MAA2C,GAAG,CAAC,CAAC;AAE/C,SAASC,uBAAuB,CAACC,YAAoB,EAAE;EAC5D,IAAIF,MAAM,CAACE,YAAY,CAAC,EAAE;IACxB;EACF;;EAEA;EACAC,OAAO,CAACC,IAAI,CAAE;AAChB;AACA,WAAWF,YAAa;AACxB,GAAG,CAAC;EAEFF,MAAM,CAACE,YAAY,CAAC,GAAG,IAAI;AAC7B;AAEO,SAASG,yBAAyB,CACvCH,YAAoB,EACpBI,OAAe,EACf;EACA,MAAM,IAAI3B,KAAK,CACZ,IAAGuB,YAAa,wGAAuGI,OAAQ,EAAC,CAClI;AACH;AAEO,SAASC,yBAAyB,CACvCL,YAAoB,EACpBM,eAAuB,EACvB;EACA,MAAM,IAAI9B,cAAc,CACrB,QAAOwB,YAAa,mCAAkCM,eAAgB,oCAAmC,EAC1GD,yBAAyB,CAC1B;AACH"}